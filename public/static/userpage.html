<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
          integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <link rel="stylesheet" href="../static/styles.css">
    <title>{NICK}'s page</title>
    <meta charset="utf-8">
</head>
<body onload="loadPics()">
<div class="flex-container">
    <div class="flex-container profile-header">
        <div class="flex-container ph-container">
            <img src="{PROFILEPIC}" alt="{NICK}'s profile picture" class="profile-pic">
            {ADDPOSTBUTTON}
        </div>
        <div class="profile-text-info">
            <div class="nick-container flex-container">
                <h1>{NICK}</h1>
                <button class="btn btn-primary btn-sm" id="operbut" onclick="{PROFILEACTIONCALL}">{PROFILEACTION}</button>
            </div>
            <h4 id="name">{NAME} {SURNAME}</h4>
            <div id="stat">
                <p>{SUBSCRIBERS} subscribers</p>
                <p>{SUBSCRIPTIONS} subscriptions</p>
                <p>{POSTS} posts</p>
            </div>
            <p id="bio">{BIO}</p>
        </div>
    </div>
</div>
<div class="flex-container profile-content" id="profile-content"></div>
<button onclick="loadPics()" class="btn btn-sm btn-secondary loadmore" id="loadmore">Load more</button>
<script type="text/javascript">
    var offset = 0;
    var sessionId = "{SESSION}";
    var pageId = "{PAGEID}";
    var picturesContainer = document.getElementById("profile-content");
    var loadModeButton = document.getElementById("loadmore");
    function loadPics(_quantity = 100) {
        const url = "getphotos.php";
        var args = {'pageId': pageId, 'quan': _quantity, "offset": offset, "sessionId": sessionId, 'mode': 'time' };
        var success = function(resp) {
            console.log(resp);
            resp = JSON.parse(resp);
            picturesContainer.innerHTML += resp.message;
            if (resp.loaded < _quantity) {
                loadModeButton.style.visibility = 'hidden';
            }
            offset += resp.loaded;
        };
        var err = function(errno, resp) {

        };
        ajax('POST', url, args, success, err);
    }
    function addPost() {
        window.location.replace('addPost.php');
    }
    function changeSettings() {
        window.location.replace('settings.php');
    }
    {PROFILEACTIONFUNC}
</script>
<script src="./static/ajax.js" type="text/javascript"></script>
</body>
</html>